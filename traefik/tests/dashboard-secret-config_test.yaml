suite: Dashboard basic auth secret configuration
templates:
  - dashboard-hook-secret.yaml
tests:
  - it: should not render when dashboard is disabled
    set:
      ingressRoute:
        dashboard:
          enabled: false
    asserts:
      - hasDocuments:
          count: 0
  - it: should use correct name
    asserts:
      - matchRegex:
          path: metadata.name
          pattern: -dashboard-auth-secret$
  - it: should generate default auth secret
    asserts:
      - matchRegex:
          path: data.auth
          pattern: "^YWRtaW4" #base64 encode data which begin with admin:
  - it: should generate correct auth when username and password is specified
    set:
      ingressRoute:
        dashboard:
          username: user
          password: password
    asserts:
      - equal:
          path: data.auth
          value: "dXNlcjo1YmFhNjFlNGM5YjkzZjNmMDY4MjI1MGI2Y2Y4MzMxYjdlZTY4ZmQ4"
